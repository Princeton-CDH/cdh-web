{% extends 'base.html' %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block page-subtitle %}{{ profile.title }} | People | {% endblock %}

{% block main %}
<div class="profile">
<header>
    <h1>{{ profile.title }}</h1>
    {# display all positions, current first; dates for non-current #}
    {% for position in profile.person.positions.all %}
        <p class="title">{% if not position.is_current %}
            {{ position.start_date.year }}{% if position.end_date.year != position.start_date.year%}-{{ position.end_date.year }}{% endif %}
            {% endif %}
        {{ position.title }}
        </p>
    {% endfor %}
</header>

<div class="links">
    {# NOTE equiv to contributors in project #}
    <ul>
    {% for link in profile.person.related_links.all %}
        <li><a href="{{ link.url }}">{{ link.type.name }}</a></li>
    {% endfor %}
    </ul>
</div>

{% if profile.image %}
    {% image profile.image fill-790x632 as profile_img %}
    <img src="{{ profile_img.url }}" alt="{{ profile.title }}"/>
{% endif %}

<div class="education">
    {{ profile.education|richtext }}
    <a href="mailto:{{ profile.person.email }}">{{ profile.person.email }}</a>
    {% if profile.person.phone_number %}
        <p>{{ profile.person.phone_number }}</p>
    {% endif %}
    {% if profile.person.office_location %}
        <p>{{ profile.person.office_location }}</p>
    {% endif %}
</div>

<div class="bio">
    {% for block in profile.bio %}
        {% include_block block %}
    {% endfor %}
</div>

{% if recent_posts %}
<div class="recent-posts">
    <h2>Recent Posts</h2>
    {% include 'blog/blogpost_list.html' with posts=recent_posts %}
</div>
{% endif %}

</div>
{% endblock %}
